`docker run`コマンドの`-p`オプションは、ホストマシンのポートをコンテナ内のポートにマッピングするために使用されます。このオプションを使うことで、コンテナ内で動作するサービスにホストマシンや外部からアクセスできるようになります。

---

### **基本構文**
```bash
docker run -p <ホストポート>:<コンテナポート> <イメージ>
```

- **ホストポート**: ホストマシンで公開するポート番号。
- **コンテナポート**: コンテナ内でサービスがリッスンしているポート番号。

---

### **例: MySQLコンテナの場合**
MySQLがデフォルトで使用する3306ポートをホストに公開する場合:

```bash
docker run -d -p 3306:3306 --name mysql-container -e MYSQL_ROOT_PASSWORD=my-secret-pw mysql
```

- `-p 3306:3306`:
  - ホストのポート`3306`をコンテナ内のポート`3306`にマッピングします。
  - ホストマシンの`3306`ポートにアクセスすると、コンテナ内のMySQLサービスに接続できます。

---

### **詳細オプション**
`-p`オプションには柔軟な指定が可能です:

1. **異なるポートをマッピング**
   - ホストとコンテナのポート番号を異なる値に設定することができます。
   - 例:
     ```bash
     docker run -d -p 8080:80 nginx
     ```
     - ホストのポート`8080`をコンテナ内の`80`ポート（Nginxのデフォルトポート）にマッピングします。
     - ブラウザで`http://localhost:8080`を開くと、Nginxのデフォルトページにアクセスできます。

2. **特定のIPアドレスでバインド**
   - ホストマシンの特定のIPアドレスにバインドすることができます。
   - 例:
     ```bash
     docker run -d -p 192.168.1.100:3306:3306 mysql
     ```
     - ホストの`192.168.1.100`の`3306`ポートのみを公開します。

3. **ランダムなホストポートを割り当て**
   - ホスト側のポートをランダムに割り当てる場合、以下のように記述します:
     ```bash
     docker run -d -p 3306 mysql
     ```
   - 実際に割り当てられたホストポートは`docker ps`で確認できます。

---

### **ポートマッピングの確認**
以下のコマンドで、ポートのマッピング状況を確認できます:
```bash
docker ps
```

出力例:
```
CONTAINER ID   IMAGE     COMMAND                  CREATED        STATUS        PORTS                     NAMES
abcd1234efgh   mysql     "docker-entrypoint..."   5 minutes ago  Up 5 minutes  0.0.0.0:3306->3306/tcp    mysql-container
```
- `0.0.0.0:3306->3306/tcp`: ホストの`3306`ポートがコンテナの`3306`ポートにマッピングされていることを示します。

---

### **注意点**
1. **ホストポートの競合**:
   - 同じホストポートを複数のコンテナで使用することはできません。
   - ポートが競合する場合、異なるポート番号を指定してください。

2. **ファイアウォール設定**:
   - ホストマシンのファイアウォールやネットワーク設定でポートがブロックされている場合、外部からの接続は失敗します。
   - 必要に応じてファイアウォールのルールを追加してください。

3. **Docker Desktop特有の制限**:
   - Docker Desktopでは、ホストマシン（通常は`localhost`）のポートを利用してコンテナにアクセスします。
   - 他のマシンからアクセスする場合、ホストマシンのIPアドレスを使用する必要があります。

これで`-p`オプションを使用して、Dockerコンテナのポート公開を正しく設定できます！
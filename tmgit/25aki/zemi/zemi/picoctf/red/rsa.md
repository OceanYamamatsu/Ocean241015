いいですね 👍
RSA暗号の「数式の仕組み」を高校生にもわかるように、できるだけやさしく説明します。

---

## 🔒 RSA暗号ってなに？

RSA暗号は、「公開鍵暗号」と呼ばれる仕組みの代表例です。
つまり、

* 暗号化するための鍵（公開鍵）は **誰でも知っていい**
* でも、復号するための鍵（秘密鍵）は **本人しか知らない**
  という仕組みです。

---

## 🧮 使う数学：整数と剰余（あまり）

RSAで使うのは難しい関数や微積ではなく、実は「割り算のあまり（mod）」です。

たとえば：

> 7 ÷ 3 のあまりは 1
> → つまり「7 ≡ 1 (mod 3)」と書きます。

RSAはこの「mod（モジュロ）」を使って暗号化と復号をします。

---

## 🧩 ステップ1：鍵の作り方（ざっくり）

1. まず、大きな素数を2つ用意します。

   ```
   p = 3,  q = 11   （実際はもっと大きな数を使う）
   ```

2. それを掛けて

   ```
   n = p × q = 33
   ```

   この「n」が暗号の世界の土台になります。

3. 次に、(p−1)(q−1) を計算します：

   ```
   φ(n) = (3−1) × (11−1) = 20
   ```

4. そして、「e」という数を選びます。
   条件は「e と φ(n) が互いに素（共通の約数が1）」です。

   ```
   e = 3
   ```

   これが「公開鍵」の一部です。

5. 最後に、「d」という数を求めます。
   これは次の式を満たすように選びます：

   ```
   e × d ≡ 1 (mod φ(n))
   ```

   今の場合、

   ```
   3 × d ≡ 1 (mod 20)
   ```

   これを満たす d は 7 です（3×7=21, 21÷20のあまり=1）。

---

## 🔑 公開鍵と秘密鍵

* 公開鍵： (e, n) = (3, 33)
* 秘密鍵： (d, n) = (7, 33)

---

## 💬 ステップ2：暗号化（送る側）

たとえば「4」を送りたいとします。

暗号文 ( C ) は次の式で作ります：

[
C = M^e \bmod n
]

ここで M = 4, e = 3, n = 33

[
C = 4^3 \bmod 33 = 64 \bmod 33 = 31
]

つまり暗号文は「31」です。

---

## 🔓 ステップ3：復号（受け取る側）

復号は次の式で行います：

[
M = C^d \bmod n
]

[
M = 31^7 \bmod 33 = 4
]

見事に元の「4」に戻りました！

---

## 💡 なんでこれで戻るの？

これには「オイラーの定理」という数学の法則が関係しています。
ざっくり言うと：

> 特定の条件のもとで
> ( M^{e \times d} \bmod n = M )

になるように、dを選んでいるからです。

---

## 🎯 まとめ

| ステップ | 内容               | 数式                 |
| ---- | ---------------- | ------------------ |
| 鍵生成  | 素数p,qからnとφ(n)を計算 | φ(n) = (p−1)(q−1)  |
| 公開鍵  | (e, n)           | eとφ(n)は互いに素        |
| 秘密鍵  | (d, n)           | e×d ≡ 1 (mod φ(n)) |
| 暗号化  | C = M^e mod n    |                    |
| 復号   | M = C^d mod n    |                    |

---

もし希望があれば、次のようなテーマでも続けて説明できます：

* 🔍 なぜ素因数分解が難しいとRSAが安全なのか
* 💻 実際にPythonで計算するデモ
* 📱 現実のRSA鍵のサイズ（1024bit, 2048bitなど）

どれに興味がありますか？

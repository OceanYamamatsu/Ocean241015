import os

# ä¸è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‰Šé™¤ï¼ˆwandbãªã—ï¼‰
!pip uninstall -y wandb

# å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
!apt -y update -qq
!apt -y install -qq aria2 git

# WebUIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
!git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git /content/stable-diffusion-webui

# Hugging Faceã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®šï¼ˆè‡ªåˆ†ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ï¼‰
os.environ["HUGGINGFACE_TOKEN"] = "aaaaaaaaaaaaaa"

# ãƒ¢ãƒ‡ãƒ«ã®URLã‚’è¨­å®šï¼ˆanimelike2dï¼‰
MODEL_URL = "https://huggingface.co/WarriorMama777/OrangeMixs/resolve/main/animelike2d.safetensors"

# ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜å…ˆ
MODEL_DIR = "/content/stable-diffusion-webui/models/Stable-diffusion"
os.makedirs(MODEL_DIR, exist_ok=True)
MODEL_PATH = os.path.join(MODEL_DIR, "animelike2d.safetensors")

# aria2ã§é«˜é€Ÿãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
def download_model(url, output_path):
    !aria2c --header="Authorization: Bearer $HUGGINGFACE_TOKEN" -o {output_path} {url}

# animelike2dã®ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
download_model(MODEL_URL, MODEL_PATH)

# Web UIã®èµ·å‹•ï¼ˆanimelike2dã‚’æŒ‡å®šï¼‰
%cd /content/stable-diffusion-webui
!python launch.py --share --no-half-vae --enable-insecure-extension-access --gradio-queue --ckpt=animelike2d.safetensors


å¤‰æ›´ã®ãƒã‚¤ãƒ³ãƒˆ
âœ… animelike2d ã®ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆstabilityai ã®æ¨™æº–ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã‚ãªã„ï¼‰
âœ… WebUI ã®èµ·å‹•æ™‚ã« animelike2d.safetensors ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
âœ… aria2c ã§é«˜é€Ÿãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚Œã°ã€Stable Diffusion WebUI ã§ animelike2d ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ ğŸ¨ğŸš€